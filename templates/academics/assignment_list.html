{% extends "base.html" %}
{% block title %}Assignments - Academic Management{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="page-title">
        <i class="fas fa-tasks me-2"></i>Assignments
    </h1>
    {% if user_role == 'FACULTY' %}
    <a class="btn btn-custom-primary" href="{% url 'academics:assignment_create' %}">
        <i class="fas fa-plus me-2"></i>New Assignment
    </a>
    {% endif %}
</div>

<div class="table-responsive">
    <table class="table table-custom">
        <thead>
            <tr>
                <th><i class="fas fa-file-alt me-2"></i>Title</th>
                <th><i class="fas fa-book me-2"></i>Subject</th>
                <th><i class="fas fa-chalkboard-teacher me-2"></i>Faculty</th>
                <th><i class="fas fa-calendar-alt me-2"></i>Due</th>
                <th><i class="fas fa-trophy me-2"></i>Max Score</th>
                {% if user_role == 'STUDENT' %}
                <th><i class="fas fa-check-circle me-2"></i>Status</th>
                {% endif %}
                {% if user_role == 'FACULTY' or user_role == 'STUDENT' %}
                <th><i class="fas fa-cog me-2"></i>Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for assignment in assignments %}
            <tr>
                <td><strong>{{ assignment.title }}</strong></td>
                <td>{{ assignment.subject }}</td>
                <td>{{ assignment.faculty }}</td>
                <td>
                    <span class="badge bg-warning">
                        <i class="fas fa-clock me-1"></i>{{ assignment.due_date|date:"M d, Y" }}
                    </span>
                </td>
                <td><span class="badge bg-primary">{{ assignment.max_score }}</span></td>
                {% if user_role == 'STUDENT' %}
                <td>
                    {% if assignment.student_submission %}
                        {% if assignment.student_submission.status == 'SUBMITTED' %}
                            <span class="badge bg-success"><i class="fas fa-check me-1"></i>Submitted</span>
                        {% elif assignment.student_submission.status == 'LATE' %}
                            <span class="badge bg-warning"><i class="fas fa-clock me-1"></i>Late</span>
                        {% else %}
                            <span class="badge bg-secondary"><i class="fas fa-hourglass-half me-1"></i>Pending</span>
                        {% endif %}
                        {% if assignment.student_submission.score %}
                            <br><small class="text-muted">Score: {{ assignment.student_submission.score }}/{{ assignment.max_score }}</small>
                        {% endif %}
                    {% else %}
                        <span class="badge bg-danger"><i class="fas fa-times me-1"></i>Not Submitted</span>
                    {% endif %}
                </td>
                <td>
                    {% if not assignment.student_submission %}
                        <a href="{% url 'academics:student_submit_assignment' assignment.pk %}" class="btn btn-sm btn-success btn-action">
                            <i class="fas fa-paper-plane me-1"></i>Submit
                        </a>
                    {% else %}
                        <span class="text-muted"><i class="fas fa-check-circle"></i> Submitted</span>
                    {% endif %}
                </td>
                {% elif user_role == 'FACULTY' %}
                <td>
                    <a href="{% url 'academics:assignment_edit' assignment.pk %}" class="btn btn-sm btn-warning btn-action me-1">
                        <i class="fas fa-edit"></i>
                    </a>
                    <a href="{% url 'academics:assignment_delete' assignment.pk %}" class="btn btn-sm btn-danger btn-action">
                        <i class="fas fa-trash"></i>
                    </a>
                </td>
                {% endif %}
            </tr>
            {% empty %}
            <tr>
                <td colspan="{% if user_role == 'FACULTY' %}6{% elif user_role == 'STUDENT' %}7{% else %}5{% endif %}" class="text-center py-5">
                    <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
                    <p class="text-muted">No assignments yet.</p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
